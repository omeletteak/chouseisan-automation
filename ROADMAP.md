# プロジェクトロードマップ: Chouseisan Automation

## ビジョン
Discordで発表されたスケジュール情報を自動で抽出し、調整さんでのイベント作成・管理、そしてGoogleカレンダーへの登録までを一貫して自動化することで、手動での入力作業をなくし、効率的なスケジュール管理を実現する。

## ロードマップのフェーズ (優先順位順)

### フェーズ1: 調整さんデータ読み取り機能の実装 (完了)

*   **目標:** 調整さんのイベントページから、日付、時間、参加者の出欠状況、コメントなどの必要な情報を正確に抽出できるようにする。

*   **主要なステップ:**
    *   [x] **HTMLコンテンツの取得:**
        *   [x] 調整さんのイベントページのURLを指定し、そのHTMLコンテンツをプログラムで取得する。
        *   [x] Pythonの `requests` ライブラリを使用する。
    *   [x] **HTMLの解析とデータ抽出:**
        *   [x] 取得したHTMLから、イベント名、開催日時、参加者の名前、各日程に対する出欠状況（〇、△、✕）、コメントなどの情報を抽出する。
        *   [x] `BeautifulSoup` を利用し、ページに埋め込まれた `window.Chouseisan` のJSONデータを解析することで、HTML構造の変更に強い安定したデータ抽出を実現。
    *   [x] **抽出データの構造化:**
        *   [x] 抽出した情報を、後続の処理で扱いやすいように、Pythonのカスタムクラス (`dataclasses`) を使用して適切なデータ構造に整理する。
        *   [x] イベント、日程、参加者、出欠情報を保持する各クラスを `src/models.py` に定義。
    *   [x] **抽出データのデータベース保存:**
        *   [x] SQLiteデータベースのセットアップ（ファイル作成、接続）。
        *   [x] イベント、日程、参加者、出欠状況を保存するためのテーブルスキーマ定義と作成。
        *   [x] 解析したデータをデータベースに挿入するロジックの実装。

*   **活用ファイル:**
    *   `src/reader.py`: HTMLコンテンツの取得を担当。
    *   `src/parser.py`: 取得したHTMLコンテンツを解析し、必要なデータを抽出・構造化するロジックを実装。
    *   `src/models.py`: イベント、参加者などのデータ構造を定義。
    *   `src/database.py`: データベースの初期化、データの保存処理を担当。
    *   `data/sample.html`: 解析ロジックを開発する際のテストデータとして活用。

### フェーズ2: 調整さん自動書き込み機能の実装

*   **目標:** プログラムから調整さんにイベントを作成したり、出欠状況を更新したりできるようにする。

*   **進捗状況:**
    *   [x] **イベント作成機能:** `Selenium` を利用して実装完了。 (`src/writer.py`)
    *   [ ] **出欠登録機能:** 実装中。
        *   **課題:** `Selenium`でのアクセスはボット検知により不安定なため、`requests`ライブラリでAPI通信を直接模倣するアプローチを採用。
        *   **状況:** CSRFトークンの取得とPOSTリクエストの送信ロジックを実装中。

*   **主要機能:**
    *   [x] 調整さんへのイベント作成フォームの自動入力
    *   [ ] 出欠状況の自動更新
    *   [ ] （必要であれば）ログイン処理の自動化

### フェーズ3: Googleカレンダー連携機能の実装

*   **目標:** 抽出した日付情報をGoogleカレンダーにイベントとして登録できるようにする。
*   **主要機能:**
    *   [ ] Google Calendar APIとの連携設定（認証含む）
    *   [ ] イベントの作成、更新、削除機能
    *   [ ] イベントのタイトル、説明、日時などの設定

### フェーズ4: Discord連携機能の実装

*   **目標:** Discordの特定のチャンネルやメッセージから日付情報を抽出し、Googleカレンダー連携に繋げられるようにする。
*   **主要機能:**
    *   [ ] Discord APIとの連携設定（ボットの作成、認証含む）
    *   [ ] メッセージの監視と日付情報のパターン認識・抽出
    *   [ ] 抽出した日付情報をGoogleカレンダー連携機能へ渡す

### フェーズ5: 全体統合と自動化

*   **目標:** 各機能を連携させ、Discordでの発表からGoogleカレンダーへの登録、調整さんでの管理までの一連の自動化フローを確立する。
*   **主要機能:**
    *   [ ] 各フェーズで実装した機能の連携ロジック
    *   [ ] エラーハンドリングと通知機能
    *   [ ] 定期実行やトリガーによる自動実行設定